
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SNE # 0. Stochastic inverse pendulum</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="author" content="jaabell" />
    <meta name="description" content="This is the first installment of "Small Numerical Experiments" (SNE …" />
    <meta name="keywords" content="animation, bimodal, matplotlib, Monte-Carlo, multimodal, ode, python, scipy, small numerical experiments, sne, stochastic">
<!-- Facebook and Twitter integration -->
<meta property="og:site_name" content="Jose Abells Reasearch Blog"/>
<meta property="og:title" content="SNE # 0. Stochastic inverse pendulum"/>
<meta property="og:description" content="This is the first installment of "Small Numerical Experiments" (SNE …"/>
<meta property="og:url" content="https://joseabell.com/posts/2013/sne-0-stochastic-inverse-pendulum.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2013-10-09 20:37:00-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://joseabell.com/author/jaabell.html">
<meta property="article:section" content="Small Numerical Experiments"/>
    <meta property="article:tag" content="animation"/>
    <meta property="article:tag" content="bimodal"/>
    <meta property="article:tag" content="matplotlib"/>
    <meta property="article:tag" content="Monte-Carlo"/>
    <meta property="article:tag" content="multimodal"/>
    <meta property="article:tag" content="ode"/>
    <meta property="article:tag" content="python"/>
    <meta property="article:tag" content="scipy"/>
    <meta property="article:tag" content="small numerical experiments"/>
    <meta property="article:tag" content="sne"/>
    <meta property="article:tag" content="stochastic"/>
    <meta property="og:image" content="/images/sitelogo.svg">

    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700" rel="stylesheet">

    <!-- Animate.css -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/bootstrap.css">
    <!-- Flexslider  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/flexslider.css">
    <!-- Theme style  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/style.css">
    <!-- Custom style  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/custom.css">
    <!-- pygments code highlight -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/pygments.css">
    <!-- tipue search -->
    <link rel="stylesheet" href="https://joseabell.com/theme/tipuesearch/css/tipuesearch.css">
    <!-- <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" > -->
    <script src="https://kit.fontawesome.com/2dfe6f2f70.js" crossorigin="anonymous"></script>


    <!-- Modernizr JS -->
    <script src="https://joseabell.com/theme/js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="/theme/js/respond.min.js"></script>
    <![endif]-->
        <link href="https://joseabell.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jose Abells Reasearch Blog Atom">




    </head>
    <body>
    <!-- Uncomment for fun -->
    <!-- <marquee bgcolor="red" height="50px" style="color:yellow;font-size:30px;"> OMG COVID--19 ALERT TAKE COVER ALL!!! </marquee> -->
    <div id="fh5co-page">
        <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
        <aside id="fh5co-aside" role="complementary" class="border js-fullheight">


            <nav class="fh5co-main-menu" role="navigation">
            </nav>


            
            <div class="clearfix"></div>
            <h1  id="fh5co-logo">
                <a href="https://joseabell.com/index.html">
                    <img src="/images/sitelogo.svg" />
                </a>
            </h1>


            <nav class="fh5co-main-menu" role="navigation">

<ul>
    <!-- home link -->
    <li><a href="https://joseabell.com/">Home</a></li>

    <!-- page links -->
            <li><a href="https://joseabell.com/pages/01about.html">About</a></li>
            <li><a href="https://joseabell.com/pages/04publications.html">Publications</a></li>
            <li><a href="https://joseabell.com/pages/05tools.html">Tools</a></li>

    <!-- categories -->
        <li><a href="https://joseabell.com/categories.html">Categories</a></li>

    <!-- tags -->
        <li><a href="https://joseabell.com/tags.html">Tags</a></li>

    <!-- additional menu items from config -->

</ul><!--                 <ul><li><form id="searchform" action="https://joseabell.com/search.html">
    <input id="tipue_search_input" data-siteurl="https://joseabell.com" type="text" size="60" class="form-control search-field" name="q">

    <button type="submit" class="btn btn-primary search-submit"><i class="icon-search4"></i></button>
</form></li></ul> -->



<ul id="social"><li>
            <li><a href="https://www.github.com/jaabell" alt="Github"><i class="fab fa-github fa-2x"></i></a></li>
            <li><a href="https://www.youtube.com/c/JoseAAbellM" alt="Youtube"><i class="fab fa-youtube fa-2x"></i></a></li>

            <li><a href="https://www.researchgate.net/profile/Jose_Abell/" alt="researchgate"><i class="fab fa-researchgate fa-2x"></i></a></li>

            <li><a href="linkedin.com/in/josé-abell-93194129" alt="linkedin"><i class="fab fa-linkedin fa-2x"></i></a></li>


</li>
</ul>            
            <ul id="map">
                <li>
                Visitors come from
                <script type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?cl=b3b3b3&w=250&t=n&d=XCjx4HKZp-atwA8u2pe4wbQt9_6FCkYMlpMpnxG6qMU&co=f5f5f5&cmo=027aae&cmn=a03338&ct=808080"></script>
                </li>
            </ul>
            </nav>

        </aside>

        <div id="fh5co-main">

    <div class="fh5co-narrow-content article-content">
        <h1 class="fh5co-heading-colored">SNE # 0. Stochastic inverse pendulum</h1>

        <div>by
                <a href="author/jaabell.html">jaabell</a> - Wed, 09 Oct 2013
        </div>

            <div><span>Tags: </span>
                    <span><a href="https://joseabell.com/tag/animation.html">#animation</a> </span>
                    <span><a href="https://joseabell.com/tag/bimodal.html">#bimodal</a> </span>
                    <span><a href="https://joseabell.com/tag/matplotlib.html">#matplotlib</a> </span>
                    <span><a href="https://joseabell.com/tag/monte-carlo.html">#Monte-Carlo</a> </span>
                    <span><a href="https://joseabell.com/tag/multimodal.html">#multimodal</a> </span>
                    <span><a href="https://joseabell.com/tag/ode.html">#ode</a> </span>
                    <span><a href="https://joseabell.com/tag/python.html">#python</a> </span>
                    <span><a href="https://joseabell.com/tag/scipy.html">#scipy</a> </span>
                    <span><a href="https://joseabell.com/tag/small-numerical-experiments.html">#small numerical experiments</a> </span>
                    <span><a href="https://joseabell.com/tag/sne.html">#sne</a> </span>
                    <span><a href="https://joseabell.com/tag/stochastic.html">#stochastic</a> </span>
            </div>

        <div class="animate-box" data-animate-effect="fadeInLeft">
            <p class="animate-box" data-animate-effect="fadeInLeft"><p>This is the first installment of "Small Numerical Experiments" (SNE), a
section where I upload and comment (briefly) some small numerical
example. The purpose is to prove a point to myself, test some code,
ideas, etc.</p>
<p><a href="/images/sne/01/pendulum_medium.png"><img alt="pendulum" src="/images/sne/01/pendulum_medium.png"></a></p>
<p>In this first post I will explore the response of a <em>stochastic inverse
pendulum.</em> What I mean in this case is an inverse pendulum (shown left)
with a random initial condition. The purpose is to obtain the
time-evolving probability density function (PDF) of the pendulum's
position. I will be doing Monte-Carlo simulations to obtain an
approximation to this PDF.  </p>
<!--more-->
<p>The response of the system is governed by the following nonlinear
ordinary differential equation in terms of the angular displacement
<span class="math">\(\theta\)</span> with respect to the vertical:</p>
<div class="math">$$
 m l^2 \ddot{\theta} + c \dot{\theta} - mgl \sin \theta = 0
$$</div>
<p>Subject to an initial condition </p>
<div class="math">$$ \theta(0) = \theta_0$$</div>
<p> and
</p>
<div class="math">$$ \dot{\theta}(0) =\dot{\theta}_0$$</div>
<p>. In this case, the initial
angular velocity is set to zero and the initial angular displacement is
set to have a Gaussian random distribution with mean zero and standard
deviation of 10 degrees. The linear damping constant is set to 10%
critical damping the system would have in the case of small oscillations
about the final equilibrium point </p>
<div class="math">$$\theta = 180^{\circ}$$</div>
<p>.</p>
<p>The example is coded in python and solved using the <em>odeint </em>solver
available in <a href="http://www.scipy.org">scipy</a>. Here is an example response for a given nonzero
initial condition.</p>
<p><a href="/images/sne/01/one.png"><img alt="one" src="/images/sne/01/one.png"></a></p>
<p>Doing 5000 Monte-Carlo draws and plotting all the responses together we
get:<a href="/images/sne/01/ensemble.png"><img alt="ensemble" src="/images/sne/01/ensemble.png"></a></p>
<p>-About half of the the pendulums swing to the left and the other half to
the right. This would result in a bimodal distribution and is a mere
artifact of the mathematical model used. Indeed, what the model
perceives as two distinct equilibrium points are actually the same
position for the pendulum. This arises because of the periodicity in the
<span class="math">\(\sin()\)</span> function.</p>
<p>From this set of motions a PDF may be computed for each time and
animated to show the evolution of the PDF with time.</p>
<div class="youtube" align="left">
<iframe width="640" height="480" src="https://www.youtube.com/embed/7nzB6LfW2ys" frameborder="0"></iframe>
</div>

<p>The bimodal distribution obtained at the end is, therefore, an artifact,
as the peaks correspond to the same final configuration for the system.
In a more complex case it might not be possible to distinguish between
peaks in PDFs which are real, ie. correspond to physically different
configurations, from those that arise from deficiencies in the
mathematical tool used.</p>
<p>These spurious peaks generate unrealistic dispersion in the distribution
of results. Is there a way to identify them and get rid of them?</p>
<p>The following python code produces these results.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/python  </span>
<span class="c1"># -*- coding: utf-8 -*-  </span>
<span class="c1"># Small numerical experiments # 00  </span>
<span class="sd">&quot;&quot;&quot;  </span>
<span class="sd">@SNE_number: 00  </span>
<span class="sd">@Title: Stochastic inverse pendulum  </span>
<span class="sd">@Idea: Show a case in which bifurcation behavior produces multimodal</span>
<span class="sd">distribution.  </span>
<span class="sd">@Tags: scipy, ode, stochastic, multimodal, bimodal, matplotlib,</span>
<span class="sd">Monte-Carlo, animation, python  </span>
<span class="sd">@Date: Created on Fri Oct 4 2013  </span>
<span class="sd">@author: jaabell  </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span><span class="w">  </span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span><span class="w">  </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">odeint</span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000</span><span class="w"> </span><span class="c1">#[] number of Monte-Carlo trials  </span>
<span class="n">mu_theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="c1">#[deg]  </span>
<span class="n">sigma_theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="c1">#[deg]  </span>
<span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="c1">#[s] Maximum time for simulation  </span>
<span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="c1">#[s] Time step for integration  </span>
<span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">#[]  </span>
<span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.81</span><span class="w"> </span><span class="c1">#[m/s\^2]  </span>
<span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.50</span><span class="w"> </span><span class="c1">#[m]  </span>
<span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="c1">#[] Ratio of critical damping (for a regular pendulum under</span>
<span class="n">small</span><span class="w"> </span><span class="n">deflections</span><span class="p">)</span><span class="w">  </span>
<span class="n">Nbins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="c1">#[] Number of bins for computing histograms  </span>
<span class="n">theta_0_dot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="c1">#[deg/sec] initial angular velocity for pendulums</span>

<span class="n">compute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">False</span><span class="w"> </span><span class="c1">#Use this in an interactive session (ie. spyder) to</span>
<span class="n">avoid</span><span class="w"> </span><span class="n">recomputing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Monte</span><span class="o">-</span><span class="n">Carlo</span><span class="w"> </span><span class="n">runs</span>

<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">l</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="c1">#[N*m*s/rad] Damping constant  </span>
<span class="n">Nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">tmax</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="c1">#[] Number of simulation timesteps</span>

<span class="c1">#Generate parameters for Monte-Carlo trials  </span>
<span class="n">mu_theta_rad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu_theta</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="w">  </span>
<span class="n">sigma_theta_rad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma_theta</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="w">  </span>
<span class="n">thetas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">N</span><span class="p">))</span><span class="o">*</span><span class="n">sigma_theta_rad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu_theta_rad</span><span class="w">  </span>
<span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>

<span class="c1">#Recast problem as a set of first order ODEs  </span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">l</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="w">  </span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="o">/</span><span class="n">l</span><span class="w">  </span>
<span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">):</span><span class="w">  </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gradient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">):</span><span class="w">  </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],[</span><span class="n">a</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">b</span><span class="p">]]</span>

<span class="c1">#Do the Monte-Carlo runs  </span>
<span class="k">if</span><span class="w"> </span><span class="n">compute</span><span class="p">:</span><span class="w">  </span>
<span class="w">    </span><span class="n">yall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="w">  </span>
<span class="w">    </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">theta_0</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">thetas</span><span class="p">:</span><span class="w">  </span>
<span class="w">        </span><span class="n">y0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">theta_0</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="n">theta_0_dot</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">]</span><span class="w">  </span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">odeint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">Dfun</span><span class="o">=</span><span class="n">gradient</span><span class="p">)</span><span class="w">  </span>
<span class="w">        </span><span class="n">yall</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="w">  </span>
<span class="w">        </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Case </span><span class="si">{}</span><span class="s2"> of </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w">  </span>
<span class="w">        </span><span class="n">i</span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>

<span class="c1"># Some plotting (animation after a tutorial found in http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/)  </span>
<span class="c1"># Also look at http://matplotlib.org/api/animation_api.html  </span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">animation</span>

<span class="c1"># First set up the figure, the axis, and the plot element we want to</span>
<span class="n">animate</span><span class="w">  </span>
<span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="w">  </span>
<span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="w">  </span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span><span class="w">  </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">270</span><span class="p">,</span><span class="mi">270</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span><span class="w">  </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\\t</span><span class="s2">heta$&quot;</span><span class="p">)</span><span class="w">  </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$f_{</span><span class="se">\\\t</span><span class="s2">heta}(</span><span class="se">\\\t</span><span class="s2">heta, t)$&quot;</span><span class="p">)</span>

<span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">time_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">270</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="c1">#, transform=ax.transAxes)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">interp1d</span><span class="w">  </span>
<span class="n">probability_thresholds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">myhistogram</span><span class="p">(</span><span class="n">y</span><span class="p">):</span><span class="w">  </span>
<span class="w">    </span><span class="n">yn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">yn</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="w">  </span>
<span class="w">    </span><span class="n">cdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">yn</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">y_bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interp1d</span><span class="p">(</span><span class="n">cdf</span><span class="p">,</span><span class="w"> </span><span class="n">yn</span><span class="p">,</span><span class="w"> </span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="w">    </span><span class="n">bounds_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">probability_thresholds</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">probability_thresholds</span><span class="p">,</span><span class="w"> </span><span class="n">y_bins</span>

<span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">():</span><span class="w">  </span>
<span class="w">    </span><span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],[])</span><span class="w">  </span>
<span class="w">    </span><span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">time_text</span>

<span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">):</span><span class="w">  </span>
<span class="w">    </span><span class="n">cdf</span><span class="p">,</span><span class="w"> </span><span class="n">y_bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myhistogram</span><span class="p">(</span><span class="n">yall</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span><span class="w">  </span>
<span class="w">    </span><span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">cdf</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_bins</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">y_bins_centers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">y_bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">::])</span><span class="w">  </span>
<span class="w">    </span><span class="c1"># pdf, y_bins = sp.histogram(yall[i,:], bins = Nbins, density =</span>
<span class="w">    </span><span class="kc">True</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="c1"># y_bins_centers = 0.5*(y_bins[0:-1] + y_bins[1::])  </span>
<span class="w">    </span><span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">y_bins_centers</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="w"> </span><span class="n">pdf</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;Time = </span><span class="si">{0:4.2f}</span><span class="s2"> s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w">  </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">time_text</span>

<span class="n">anim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">animate</span><span class="p">,</span><span class="w"> </span><span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span><span class="w">  </span>
<span class="n">frames</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="w">  </span>
<span class="c1">#anim.save(&#39;basic_animation.mp4&#39;, fps=30, extra_args=[&#39;-vcodec&#39;,</span>
<span class="s1">&#39;libx264&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#plt.figure()  </span>
<span class="c1">#plt.plot(t,yall[:,0]*180/sp.pi)  </span>
<span class="c1">#plt.grid()  </span>
<span class="c1">#plt.yticks(sp.linspace(-270,270,num=13))  </span>
<span class="c1">#plt.xlabel(&quot;$t$&quot;)  </span>
<span class="c1">#plt.ylabel(&quot;$\\\theta(t)$&quot;)</span>
</code></pre></div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "left",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js','color.js','mhchem.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'gray ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></p>
        </div>
    </div>

<div class="fh5co-narrow-content">
<div class="animate-box" data-animate-effect="fadeInLeft">
    <h2><!-- <i class="icon-speech-bubble"></i>  -->Comments</h2>
</div>
<div class="animate-box" data-animate-effect="fadeInLeft">
    <div id="disqus_thread"></div>
</div>

<!-- <script>
var disqus_config = function () { 
  this.language = "en";
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript><a href="https://disqus.com/?ref_noscript">Please enable JavaScript to view the comments powered by Disqus.</a></noscript> -->

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

// var disqus_config = function () {
// this.page.url = www.joseabell.com;  // Replace PAGE_URL with your page's canonical URL variable
// this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
// };

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://joseabell.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://joseabell.com/theme/js/jquery.min.js"></script>
    <!-- jQuery Easing -->
    <script src="https://joseabell.com/theme/js/jquery.easing.1.3.js"></script>
    <!-- Bootstrap -->
    <script src="https://joseabell.com/theme/js/bootstrap.min.js"></script>
    <!-- Waypoints -->
    <script src="https://joseabell.com/theme/js/jquery.waypoints.min.js"></script>
    <!-- Flexslider -->
    <script src="https://joseabell.com/theme/js/jquery.flexslider-min.js"></script>

    

    <!-- MAIN JS -->
    <script src="https://joseabell.com/theme/js/main.js"></script>
    <script id="dsq-count-scr" src="//joseabell.disqus.com/count.js" async></script>
    
    </body>
</html>
