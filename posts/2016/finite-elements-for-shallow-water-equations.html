
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Finite Elements for Shallow Water Equations</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="author" content="jaabell" />
    <meta name="description" content="$$ \newcommand{\pare}[1]{\left( #1 \right)} \newcommand{\brak}[1]{\left …" />
    <meta name="keywords" content="Finite Elements, Fluids, Shallow water equations, Tutorial">
<!-- Facebook and Twitter integration -->
<meta property="og:site_name" content="Jose Abells Reasearch Blog"/>
<meta property="og:title" content="Finite Elements for Shallow Water Equations"/>
<meta property="og:description" content="$$ \newcommand{\pare}[1]{\left( #1 \right)} \newcommand{\brak}[1]{\left …"/>
<meta property="og:url" content="https://joseabell.com/posts/2016/finite-elements-for-shallow-water-equations.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-11-22 14:55:42-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://joseabell.com/author/jaabell.html">
<meta property="article:section" content="Teaching"/>
    <meta property="article:tag" content="Finite Elements"/>
    <meta property="article:tag" content="Fluids"/>
    <meta property="article:tag" content="Shallow water equations"/>
    <meta property="article:tag" content="Tutorial"/>
    <meta property="og:image" content="/images/sitelogo.svg">

    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700" rel="stylesheet">

    <!-- Animate.css -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/bootstrap.css">
    <!-- Flexslider  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/flexslider.css">
    <!-- Theme style  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/style.css">
    <!-- Custom style  -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/custom.css">
    <!-- pygments code highlight -->
    <link rel="stylesheet" href="https://joseabell.com/theme/css/pygments.css">
    <!-- tipue search -->
    <link rel="stylesheet" href="https://joseabell.com/theme/tipuesearch/css/tipuesearch.css">
    <!-- <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" > -->
    <script src="https://kit.fontawesome.com/2dfe6f2f70.js" crossorigin="anonymous"></script>


    <!-- Modernizr JS -->
    <script src="https://joseabell.com/theme/js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="/theme/js/respond.min.js"></script>
    <![endif]-->
        <link href="https://joseabell.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jose Abells Reasearch Blog Atom">




    </head>
    <body>
    <!-- Uncomment for fun -->
    <!-- <marquee bgcolor="red" height="50px" style="color:yellow;font-size:30px;"> OMG COVID--19 ALERT TAKE COVER ALL!!! </marquee> -->
    <div id="fh5co-page">
        <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
        <aside id="fh5co-aside" role="complementary" class="border js-fullheight">


            <nav class="fh5co-main-menu" role="navigation">
            </nav>


            
            <div class="clearfix"></div>
            <h1  id="fh5co-logo">
                <a href="https://joseabell.com/index.html">
                    <img src="/images/sitelogo.svg" />
                </a>
            </h1>


            <nav class="fh5co-main-menu" role="navigation">

<ul>
    <!-- home link -->
    <li><a href="https://joseabell.com/">Home</a></li>

    <!-- page links -->
            <li><a href="https://joseabell.com/pages/01about.html">About</a></li>
            <li><a href="https://joseabell.com/pages/04publications.html">Publications</a></li>
            <li><a href="https://joseabell.com/pages/05tools.html">Tools</a></li>

    <!-- categories -->
        <li><a href="https://joseabell.com/categories.html">Categories</a></li>

    <!-- tags -->
        <li><a href="https://joseabell.com/tags.html">Tags</a></li>

    <!-- additional menu items from config -->

</ul><!--                 <ul><li><form id="searchform" action="https://joseabell.com/search.html">
    <input id="tipue_search_input" data-siteurl="https://joseabell.com" type="text" size="60" class="form-control search-field" name="q">

    <button type="submit" class="btn btn-primary search-submit"><i class="icon-search4"></i></button>
</form></li></ul> -->



<ul id="social"><li>
            <li><a href="https://www.github.com/jaabell" alt="Github"><i class="fab fa-github fa-2x"></i></a></li>
            <li><a href="https://www.youtube.com/c/JoseAAbellM" alt="Youtube"><i class="fab fa-youtube fa-2x"></i></a></li>

            <li><a href="https://www.researchgate.net/profile/Jose_Abell/" alt="researchgate"><i class="fab fa-researchgate fa-2x"></i></a></li>

            <li><a href="linkedin.com/in/josé-abell-93194129" alt="linkedin"><i class="fab fa-linkedin fa-2x"></i></a></li>


</li>
</ul>            
            <ul id="map">
                <li>
                Visitors come from
                <script type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?cl=b3b3b3&w=250&t=n&d=XCjx4HKZp-atwA8u2pe4wbQt9_6FCkYMlpMpnxG6qMU&co=f5f5f5&cmo=027aae&cmn=a03338&ct=808080"></script>
                </li>
            </ul>
            </nav>

        </aside>

        <div id="fh5co-main">

    <div class="fh5co-narrow-content article-content">
        <h1 class="fh5co-heading-colored">Finite Elements for Shallow Water Equations</h1>

        <div>by
                <a href="author/jaabell.html">jaabell</a> - Tue, 22 Nov 2016
        </div>

            <div><span>Tags: </span>
                    <span><a href="https://joseabell.com/tag/finite-elements.html">#Finite Elements</a> </span>
                    <span><a href="https://joseabell.com/tag/fluids.html">#Fluids</a> </span>
                    <span><a href="https://joseabell.com/tag/shallow-water-equations.html">#Shallow water equations</a> </span>
                    <span><a href="https://joseabell.com/tag/tutorial.html">#Tutorial</a> </span>
            </div>

        <div class="animate-box" data-animate-effect="fadeInLeft">
            <p class="animate-box" data-animate-effect="fadeInLeft"><div class="videoWrapper" align="left">
<iframe width="640" height="480" src="https://www.youtube.com/embed/ghdvW-2XzKA" frameborder="0" allowfullscreen></iframe>
</div>

<div class="math">$$
\newcommand{\pare}[1]{\left( #1 \right)}
\newcommand{\brak}[1]{\left[ #1 \right]}
\newcommand{\brac}[1]{\left\lbrace #1 \right\rbrace}
\newcommand{\absol}[1]{\left\vert #1 \right\vert}
\newcommand{\overbar}[1]{\mkern 1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}
\newcommand{\EE}[1]{\times 10^{#1}}
\newcommand{\eqand}{\, \text{and} \,}
\newcommand{\qeqand}{\quad \text{and} \quad}
\newcommand{\qqeqand}{\qquad \text{and} \qquad}
\newcommand{\HRule}{\rule{\linewidth}{0.2mm}}
\newcommand{\vect}[1]{\boldsymbol{#1}}
\newcommand{\uv}[1]{\hat{\boldsymbol{#1}}}
\newcommand{\ud}{\,\mathrm{d}}
\newcommand{\matorvec}[2]{\left[\begin{array}{#1}    #2\end{array}\right]}
\newcommand{\pardiff}[2]{\dfrac{\partial\, #1}{\partial\, #2}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\totdiff}[2]{\dfrac{\ud #1}{\ud #2}}
\newcommand{\rint}{\pare{R}\hspace{-0.5em} \int }
\newcommand{\expon}[1]{\exp \left\lbrace #1 \right\rbrace}
\newcommand{\unit}[1]{   \, \mathrm{#1}                } 
\newcommand{\bunit}[1]{  \, \left[ \mathrm{#1} \right] } 
\newcommand{\funit}[2]{  \, \mathrm{ \frac{#1}{#2} }   } 
\newcommand{\bfunit}[2]{  \, \left[ \mathrm{ {#1}/{#2} } \right]   } 
\newcommand{\mts}{\bunit{m}}
\newcommand{\cmts}{\bunit{cm}}
\newcommand{\mmts}{\bunit{mm}}
\newcommand{\kmts}{\bunit{km}}
\newcommand{\mps}{\bfunit{m}{s}}
\newcommand{\cmpt}{\bfunit{cm}{s}}
\newcommand{\mmps}{\bfunit{mm}{s}}
\newcommand{\kmps}{\bfunit{km}{s}}
\newcommand{\Newt}{\bunit{N}}
\newcommand{\kNewt}{\bunit{kN}}
\newcommand{\MNewt}{\bunit{MN}}
\newcommand{\Pa}{\bunit{Pa}}
\newcommand{\kPa}{\bunit{kPa}}
\newcommand{\MPa}{\bunit{MPa}}
\newcommand{\GPa}{\bunit{GPa}}
\newcommand{\kNmm}{\bfunit{kN}{m^2}}
\newcommand{\Nmm}{\bfunit{N}{m^2}}
\newcommand{\kgmmm}{\bfunit{kg}{m^3}}
\newcommand{\Mgmmm}{\bfunit{Mg}{m^3}}
\newcommand{\grcmcmcm}{\bfunit{g}{cm^3}}
\newcommand{\kNmmm}{\bfunit{kN}{m^3}}
\newcommand{\gr}{\bunit{g}}
\newcommand{\mgr}{\bunit{mg}}
\newcommand{\kgr}{\bunit{kg}}
\newcommand{\Mgr}{\bunit{Mg}}
\newcommand{\seg}{\bunit{s}}
\newcommand{\msec}{\bunit{ms}}
\newcommand{\musec}{\bunit{\mu s}}
\newcommand{\mo}{\bunit{month}}
\newcommand{\mos}{\bunit{months}}
\newcommand{\days}{\bunit{days}}
\newcommand{\gs}{\bunit{g}}
\newcommand{\mss}{\bfunit{m}{s^2}}
\newcommand{\cmss}{\bfunit{cm}{s^2}}
\newcommand{\Hz}{\bunit{Hz}}
\newcommand{\MHz}{\bunit{MHz}}
\newcommand{\GHz}{\bunit{GHz}}
\newcommand{\THz}{\bunit{THz}}
\newcommand{\dgr}{\unit{^{\circ}}}
\newcommand{\rads}{\bunit{rad}}
\newcommand{\kips}{\unit{kips}}
\newcommand{\ksi}{\unit{ksi}}
\newcommand{\inch}{\unit{in}}
$$</div>
<p>The linear <a href="https://en.wikipedia.org/wiki/Shallow_water_equations">shallow water equations</a> (SWE) are used extensively to model propagation of waves in situations where lateral domain dimensions are much greater than fluid height and, at the same time, wave perturbation height are much smaller than the fluid height. This finds useful applications in the case of tsunami-wave propagation modeling in deep-sea. The equations, after heavy linearization, are given by:</p>
<div class="math">$$\begin{aligned}
\pardiff{u}{t} -  f v = -g \pardiff{h}{x} \\ 
\pardiff{v}{t} +  f v = -g \pardiff{h}{y} \\
\pardiff{h}{t} = -H \pare{  \pardiff{u}{x} + \pardiff{v}{y}  }\end{aligned}$$</div>
<p>Where</p>
<ul>
<li>
<p><span class="math">\(u\)</span> is the speed in <span class="math">\(x\)</span> direction.</p>
</li>
<li>
<p><span class="math">\(v\)</span> is the speed in <span class="math">\(y\)</span> direction.</p>
</li>
<li>
<p><span class="math">\(h\)</span> wave perturbation height. (Free surface is at <span class="math">\(h+H\)</span>)</p>
</li>
<li>
<p><span class="math">\(f\)</span> Coriolis force, given by:</p>
<p>
<div class="math">$$\begin{aligned}
    f = 2 \Omega \sin \phi
    \end{aligned}$$</div>
</p>
<p>where <span class="math">\(\Omega\)</span> is Earth's angular velocity (<span class="math">\(\pi/12 \, \brak{\mathrm{rad/h}}\)</span>) and <span class="math">\(\phi\)</span> is latitude. </p>
</li>
<li>
<p><span class="math">\(g\)</span> acceleration due to gravity at given point in Earth.</p>
</li>
<li>
<p><span class="math">\(H\)</span> fluid free surface height at repose. </p>
</li>
</ul>
<p>To complete the formulation, appropriate boundary conditions are needed. </p>
<p>These equations will be discretized using Galerkin finite-element formulation. For this purpose we will be using the first order triangle finite element (see Felippa's chapter 15 <a href="http://www.colorado.edu/engineering/CAS/courses.d/IFEM.d/IFEM.Ch15.d/IFEM.Ch15.index.html">here</a> for basic notation and details regarding triangular shape functions).</p>
<p>The SWE represent the space-time evolution of three scalar fields, namely <span class="math">\(h\)</span>, <span class="math">\(u\)</span>, and <span class="math">\(v\)</span>. These three independent variables are the 3 degrees-of-freedom (DOF) of the problem. Therefore, each node will have information about these three DOFs. </p>
<p>Using the basic 3-node triangle with interpolation functions given by the triangular coordinates (see Felippa IFEM Ch. 15 and <a href="https://en.wikipedia.org/wiki/Barycentric_coordinate_system">this</a> for more info), these fields are interpolated as follows.</p>
<div class="math">$$\begin{aligned}
h = \sum N_i h_i = \vect{N} \vect{h} = \matorvec{ccc}{ \zeta_1 &amp; \zeta_2 &amp; \zeta_3 } \matorvec{c}{h_1\\h_2\\h_3}  \\ 
u = \sum N_i u_i = \vect{N} \vect{u} = \matorvec{ccc}{ \zeta_1 &amp; \zeta_2 &amp; \zeta_3 } \matorvec{c}{u_1\\u_2\\u_3} \\
v = \sum N_i v_i = \vect{N} \vect{v} = \matorvec{ccc}{ \zeta_1 &amp; \zeta_2 &amp; \zeta_3 } \matorvec{c}{v_1\\v_2\\v_3} \end{aligned}$$</div>
<p>Where <span class="math">\(\zeta_i\)</span> are triangular coordinates and <span class="math">\(u_i\)</span>, <span class="math">\(v_i\)</span>, and
<span class="math">\(h_i\)</span> the nodal values of the scalar fields at node <span class="math">\(i\)</span>.</p>
<p>As typical, we multiply the equations by a trial shape function <span class="math">\(N_j\)</span> and integrate over the domain of the element <span class="math">\(\Omega^e\)</span>, carrying out integration by parts. We arrive at the weak form of the SWE. </p>
<div class="math">$$\begin{aligned}
\pare{ \int_{\Omega^e}  N_i N_j \ud \Omega^e} \dot{h}_j - 
\pare{ \int_{\Omega^e}  H \pardiff{N_i}{x} N_j \ud \Omega^e} u_j -
\pare{ \int_{\Omega^e}  H \pardiff{N_i}{y} N_j \ud \Omega^e} v_j = 0 \\
\pare{ \int_{\Omega^e}  N_i N_j \ud \Omega^e} \dot{u}_j -
\pare{ \int_{\Omega^e}  f N_i N_j \ud \Omega^e} v_j + 
\pare{ \int_{\Omega^e}  g N_i \pardiff{N_j}{x}  \ud \Omega^e} h_j = 0 \\
\pare{ \int_{\Omega^e}  N_i N_j \ud \Omega^e} \dot{v}_j +
\pare{ \int_{\Omega^e}  f N_i N_j \ud \Omega^e} u_j + 
\pare{ \int_{\Omega^e}  g N_i \pardiff{N_j}{y}  \ud \Omega^e} h_j = 0 \end{aligned}$$</div>
<p>Here, for the first order triangle, we simply have that 1 <span class="math">\(N_i = \zeta_i\)</span>. Defining the vector of nodal freedoms <span class="math">\(\vect{z}\)</span> as:</p>
<div class="math">$$\begin{aligned}
\vect{z}^T = \matorvec{ccccccccc}{h_1 &amp; h_2 &amp; h_3 &amp; u_1 &amp; u_2 &amp; u_3 &amp; v_1 &amp; v_2 &amp; v_3 }^T\end{aligned}$$</div>
<p>The above equations can be re-written as follows:</p>
<div class="math">$$\begin{aligned}
\matorvec{ccc}
{
    \vect{M} &amp; \vect{0} &amp; \vect{0} \\
    \vect{0} &amp; \vect{M} &amp; \vect{0} \\
    \vect{0} &amp; \vect{0} &amp; \vect{M} 
} \dot{\vect{z}}  + 
\matorvec{ccc}
{
    \vect{0}        &amp; -\vect{K}_{hu} &amp; -\vect{K}_{hv} \\
    \vect{K}_{uh}   &amp; \vect{0} &amp; -\vect{K}_{uv} \\
    \vect{K}_{vh}   &amp; \vect{K}_{vu} &amp; \vect{0} 
} \vect{z}
=
\matorvec{c}
{
    \vect{0} \\ \vect{0} \\ \vect{0}
} \\ 
\vect{A} \dot{\vect{z}} + \vect{B}  \vect{z} = \vect{0}\end{aligned}$$</div>
<p>Where the involved sub-matrices are given by the following matrix integrals:</p>
<div class="math">$$\begin{aligned}
     &amp; \vect{M} = \int_{\Omega^e} \vect{N}^T \vect{N} \ud \Omega^e \\
     &amp; \vect{K}_{hu} = \int_{\Omega^e} H \pare{\pardiff{\vect{N}}{x}}^T \vect{N}  \ud \Omega^e \\
     &amp; \vect{K}_{hv} = \int_{\Omega^e} H \pare{\pardiff{\vect{N}}{y}}^T \vect{N}  \ud \Omega^e \\
     &amp; \vect{K}_{uh} = \int_{\Omega^e} g \vect{N}^T \pardiff{\vect{N}}{x} \ud \Omega^e \\
     &amp; \vect{K}_{vh} = \int_{\Omega^e} g \vect{N}^T \pardiff{\vect{N}}{y} \ud \Omega^e \\
     &amp; \vect{K}_{uv} = \int_{\Omega^e} f \vect{N}^T \vect{N} \ud \Omega^e \\
     &amp; \vect{K}_{vu} = \int_{\Omega^e} f \vect{N}^T \vect{N} \ud \Omega^e \end{aligned}$$</div>
<p>The derivatives <span class="math">\(\pardiff{\vect{N}}{x}\)</span> y <span class="math">\(\pardiff{\vect{N}}{y}\)</span> can be evaluated component-wise (again, see Felippa's work):</p>
<div class="math">$$\begin{aligned}
\matorvec{c}
{
    \pardiff{N_i}{x} \\
    \pardiff{N_i}{y} 
} = 
\dfrac{1}{2A}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12} \\
    x_{32} &amp; x_{13} &amp; x_{21} 
}
\matorvec{c}
{
    \pardiff{N_i}{\zeta_1} \\
    \pardiff{N_i}{\zeta_2} \\
    \pardiff{N_i}{\zeta_3}
}\end{aligned}$$</div>
<p>For example, for <span class="math">\(N_1\)</span>:</p>
<div class="math">$$\begin{aligned}
\matorvec{c}
{
    \pardiff{N_1}{x} \\
    \pardiff{N_1}{y} 
} = 
\matorvec{c}
{
    \pardiff{\zeta_1}{x} \\
    \pardiff{\zeta_1}{y} 
} = 
\dfrac{1}{2A}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12} \\
    x_{32} &amp; x_{13} &amp; x_{21} 
}
\matorvec{c}
{
    \pardiff{\zeta_1}{\zeta_1} \\
    \pardiff{\zeta_1}{\zeta_2} \\
    \pardiff{\zeta_1}{\zeta_3}
}
=
\dfrac{1}{2A}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12} \\
    x_{32} &amp; x_{13} &amp; x_{21} 
}
\matorvec{c}
{
    1 \\
    0 \\
    0
}
= 
\dfrac{1}{2A}
\matorvec{c}
{
    y_{23} \\
    x_{32} 
}\end{aligned}$$</div>
<p>It is clear that, therefore</p>
<div class="math">$$\begin{aligned}
\pardiff{\vect{N}}{x} = \dfrac{1}{2A}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12} 
} \\ 
\pardiff{\vect{N}}{y} = \dfrac{1}{2A}
\matorvec{ccc}
{
    x_{32} &amp; x_{13} &amp; x_{21} 
}\end{aligned}$$</div>
<p>Note that these derivatives are constant within each trinagle (hence the name, constant strain triangle although the interpretation is not strain in this case). In this context we have that <span class="math">\(x_{ij} = x_i - x_j\)</span> where  <span class="math">\(x_i\)</span> is the <span class="math">\(x\)</span> coordinate of the <span class="math">\(i\)</span>-th element node. Similarly for <span class="math">\(y_{ij} = y_i - y_j\)</span>.</p>
<p>If we further assume that the gravity field <span class="math">\(g\)</span>, the local depth at the finite element and the Coriolis force <span class="math">\(f\)</span> are constant (probably a bad assumption for this variable for some applications which span the globe) <em>within an element</em> we can further reduce the discretized equations to:</p>
<div class="math">$$\begin{aligned}
\vect{I}_{1} &amp;= \int_{\Omega^e} \vect{N}^T \vect{N} \ud \Omega^e  \\
\vect{I}_{2} &amp;= \int_{\Omega^e} \vect{N}^T \pardiff{\vect{N}}{x} \ud \Omega^e \\
\vect{I}_{3} &amp;= \int_{\Omega^e} \vect{N}^T \pardiff{\vect{N}}{y} \ud \Omega^e\end{aligned}$$</div>
<p>Working on the first integral</p>
<div class="math">$$\begin{aligned}
       \vect{I}_1 &amp;= \int_{\Omega^e} \matorvec{c}{ \zeta_1 \\ \zeta_2 \\ \zeta_3 } \matorvec{ccc}{ \zeta_1 &amp; \zeta_2 &amp; \zeta_3 } \ud \Omega^e\\
       &amp;=
       \int_{\Omega^e}  
        \matorvec{ccc}
        { 
            {\zeta_1}^2 &amp; \zeta_2\zeta_1 &amp; \zeta_3 \zeta_1 \\
            \zeta_1\zeta_2 &amp; {\zeta_2}^2 &amp; \zeta_3\zeta_2  \\
            \zeta_1\zeta_3 &amp; \zeta_2\zeta_3 &amp; {\zeta_3}^2  \\
        } 
        \ud \Omega^e \end{aligned}$$</div>
<p>We can use the following formula for the integration within a triangle of the monomials (again, from <a href="feli">here</a>)</p>
<div class="math">$$\begin{aligned}
\int_{\Omega^e} {\zeta_1}^p{\zeta_2}^q{\zeta_2}^r \ud \Omega^e = \dfrac{2 A p!\, q!\, r!}{\pare{p+q+r+2}!}\end{aligned}$$</div>
<p>With this, the integral for <span class="math">\(\vect{I}_1\)</span> is evaluated to</p>
<div class="math">$$\begin{aligned}
\vect{I}_1 = \dfrac{A}{12} \matorvec{ccc}
        { 
            2 &amp; 1 &amp; 1 \\
            1 &amp; 2 &amp; 1 \\
            1 &amp; 1 &amp; 2
        } \end{aligned}$$</div>
<p>Proceeding with the next integral:</p>
<div class="math">$$\begin{aligned}
\vect{I}_{2} &amp;= \int_{\Omega^e} \vect{N}^T \pardiff{\vect{N}}{x} \ud \Omega^e \\ 
 &amp;= \int_{\Omega^e} \matorvec{c}{ \zeta_1 \\ \zeta_2 \\ \zeta_3 } 
\dfrac{1}{2A}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12} 
}  \ud \Omega^e = 
\int_{\Omega^e} \matorvec{c}{ \zeta_1 \\ \zeta_2 \\ \zeta_3 }  \ud \Omega^e
\cdot 
\dfrac{1}{2A}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12} 
}\\ \end{aligned}$$</div>
<p>Utilizing the same identity as before to evaluate the integrals we arrive at:</p>
<div class="math">$$\begin{aligned}
\vect{I}_2 = \dfrac{A}{3} \matorvec{c}{ 1 \\ 1 \\ 1 }\dfrac{1}{2A}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12} 
} = 
\dfrac{1}{6}
\matorvec{ccc}
{
    y_{23} &amp; y_{31} &amp; y_{12}  \\
    y_{23} &amp; y_{31} &amp; y_{12} \\
    y_{23} &amp; y_{31} &amp; y_{12} 
}\end{aligned}$$</div>
<p>Analogously for <span class="math">\(\vect{I}_3\)</span> we have:</p>
<div class="math">$$\begin{aligned}
\vect{I}_{3} &amp;= \int_{\Omega^e} \vect{N}^T \pardiff{\vect{N}}{y} \ud \Omega^e = \dfrac{1}{6}
\matorvec{ccc}
{
    x_{32} &amp; x_{13} &amp; x_{21} \\
    x_{32} &amp; x_{13} &amp; x_{21} \\
    x_{32} &amp; x_{13} &amp; x_{21} 
}\end{aligned}$$</div>
<p>And finally we can write the sub-matrices as follows. </p>
<div class="math">$$\begin{aligned}
 \vect{M} &amp;= \vect{I}_1 \\
 \vect{K}_{hu} &amp;=  H \cdot {\vect{I}_2}^T &amp; \vect{K}_{hv} &amp;=  H \cdot {\vect{I}_3}^T \\
 \vect{K}_{uh} &amp;=  g \cdot \vect{I}_2 &amp; \vect{K}_{vh} &amp;=  g \cdot \vect{I}_3 \\
 \vect{K}_{uv} &amp;=  f \cdot \vect{I}_1 &amp; \vect{K}_{vu} &amp;=  f \cdot \vect{I}_1 \end{aligned}$$</div>
<p>Which can be replaced into 
</p>
<div class="math">$$\begin{aligned}
\matorvec{ccc}
{
    \vect{M} &amp; \vect{0} &amp; \vect{0} \\
    \vect{0} &amp; \vect{M} &amp; \vect{0} \\
    \vect{0} &amp; \vect{0} &amp; \vect{M} 
} \dot{\vect{z}}  + 
\matorvec{ccc}
{
    \vect{0}        &amp; -\vect{K}_{hu} &amp; -\vect{K}_{hv} \\
    \vect{K}_{uh}   &amp; \vect{0} &amp; -\vect{K}_{uv} \\
    \vect{K}_{vh}   &amp; \vect{K}_{vu} &amp; \vect{0} 
} \vect{z}
=
\matorvec{c}
{
    \vect{0} \\ \vect{0} \\ \vect{0}
} \\ 
\vect{A} \dot{\vect{z}} + \vect{B}  \vect{z} = \vect{0}\end{aligned}$$</div>
<p>
to generate the discretized SWE. </p>
<p>A future post will discuss the python implementation of this finite element and its application to a basic problem. </p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "left",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js','color.js','mhchem.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'gray ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></p>
        </div>
    </div>

<div class="fh5co-narrow-content">
<div class="animate-box" data-animate-effect="fadeInLeft">
    <h2><!-- <i class="icon-speech-bubble"></i>  -->Comments</h2>
</div>
<div class="animate-box" data-animate-effect="fadeInLeft">
    <div id="disqus_thread"></div>
</div>

<!-- <script>
var disqus_config = function () { 
  this.language = "en";
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript><a href="https://disqus.com/?ref_noscript">Please enable JavaScript to view the comments powered by Disqus.</a></noscript> -->

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

// var disqus_config = function () {
// this.page.url = www.joseabell.com;  // Replace PAGE_URL with your page's canonical URL variable
// this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
// };

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://joseabell.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://joseabell.com/theme/js/jquery.min.js"></script>
    <!-- jQuery Easing -->
    <script src="https://joseabell.com/theme/js/jquery.easing.1.3.js"></script>
    <!-- Bootstrap -->
    <script src="https://joseabell.com/theme/js/bootstrap.min.js"></script>
    <!-- Waypoints -->
    <script src="https://joseabell.com/theme/js/jquery.waypoints.min.js"></script>
    <!-- Flexslider -->
    <script src="https://joseabell.com/theme/js/jquery.flexslider-min.js"></script>

    

    <!-- MAIN JS -->
    <script src="https://joseabell.com/theme/js/main.js"></script>
    <script id="dsq-count-scr" src="//joseabell.disqus.com/count.js" async></script>
    
    </body>
</html>
