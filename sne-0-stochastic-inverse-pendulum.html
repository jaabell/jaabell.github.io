<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Jose Abell">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title><span class="caps">SNE</span> # 0. Stochastic inverse&nbsp;pendulum | Jose Abell's Research Blog</title>

        <link rel="alternate" type="application/atom+xml" title="Jose Abell's Research Blog blog atom feed" href="/feeds/all.atom.xml" />
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
        <link rel="stylesheet" href="/theme/css/pygments.css">
        <link rel="stylesheet" href="/theme/css/main.css">


    </head>

    <body>
        <header class="main-header" style="background: url('/images/header.png') no-repeat center center #DDD; background-size: 100%;">
        <h1 id="title"> José Abell's research blog</h1>
        <hr>
        <nav>
            <div class="container">
            <ul>
                <li><a href="/" title="Home">Home</a></li>
                        <li><a href="http://www.joseabell.com/pages/01about.html">About</a></li>
                        <li><a href="http://www.joseabell.com/pages/02research.html">Research</a></li>
                        <li><a href="http://www.joseabell.com/pages/03teaching.html">Teaching</a></li>
                        <li><a href="http://www.joseabell.com/pages/04publications.html">Publications</a></li>
                        <li><a href="http://www.joseabell.com/pages/05tools.html">Tools</a></li>
                        <li><a href="http://www.joseabell.com/pages/06cv.html"><span class="caps">CV</span></a></li>
                        <li><a href="http://www.joseabell.com/pages/07links.html">Links</a></li>
                        <li><a href="http://www.joseabell.com/pages/08prospective-students.html">Prospective&nbsp;Students</a></li>
            </ul>
            </div>
        </nav>
        </header>

<div class="container post">

    <article>
        <header>
            <h1><span class="caps">SNE</span> # 0. Stochastic inverse&nbsp;pendulum</h1>
            <time datetime="article.date.isoformat()" pubdate>Wed 09 October 2013</time>
        </header>

        <div class="article_content">
            <p>This is the first installment of &#8220;Small Numerical Experiments&#8221; (<span class="caps">SNE</span>), a
section where I upload and comment (briefly) some small numerical
example. The purpose is to prove a point to myself, test some code,
ideas,&nbsp;etc.</p>
<p><a href="/images/sne/01/pendulum_medium.png"><img alt="pendulum" src="/images/sne/01/pendulum_medium.png"></a></p>
<p>In this first post I will explore the response of a <em>stochastic inverse
pendulum.</em> What I mean in this case is an inverse pendulum (shown left)
with a random initial condition. The purpose is to obtain the
time-evolving probability density function (<span class="caps">PDF</span>) of the pendulum&#8217;s
position. I will be doing Monte-Carlo simulations to obtain an
approximation to this <span class="caps">PDF</span>.<br>
<!--more--><br>
The response of the system is governed by the following nonlinear
ordinary differential equation in terms of the angular displacement
<span class="math">\(\theta\)</span> with respect to the&nbsp;vertical:</p>
<div class="math">$$
 m l^2 \ddot{\theta} + c \dot{\theta} - mgl \sin \theta = 0
$$</div>
<p>Subject to an initial&nbsp;condition </p>
<div class="math">$$ \theta(0) = \theta_0$$</div>
<p> and
</p>
<div class="math">$$ \dot{\theta}(0) =\dot{\theta}_0$$</div>
<p>. In this case, the initial
angular velocity is set to zero and the initial angular displacement is
set to have a Gaussian random distribution with mean zero and standard
deviation of 10 degrees. The linear damping constant is set to 10%
critical damping the system would have in the case of small oscillations
about the final equilibrium&nbsp;point </p>
<div class="math">$$\theta = 180^{\circ}$$</div>
<p>.</p>
<p>The example is coded in python and solved using the <em>odeint </em>solver
available in <a href="http://www.scipy.org">scipy</a>. Here is an example response for a given nonzero
initial&nbsp;condition.</p>
<p><a href="/images/sne/01/one.png"><img alt="one" src="/images/sne/01/one.png"></a></p>
<p>Doing 5000 Monte-Carlo draws and plotting all the responses together we
get:<a href="/images/sne/01/ensemble.png"><img alt="ensemble" src="/images/sne/01/ensemble.png"></a></p>
<p>-About half of the the pendulums swing to the left and the other half to
the right. This would result in a bimodal distribution and is a mere
artifact of the mathematical model used. Indeed, what the model
perceives as two distinct equilibrium points are actually the same
position for the pendulum. This arises because of the periodicity in the
<span class="math">\(\sin()\)</span>&nbsp;function.</p>
<p>From this set of motions a <span class="caps">PDF</span> may be computed for each time and
animated to show the evolution of the <span class="caps">PDF</span> with&nbsp;time.</p>
<div class="youtube" align="left">
<iframe width="640" height="480" src="https://www.youtube.com/embed/7nzB6LfW2ys" frameborder="0"></iframe>
</div>

<p>The bimodal distribution obtained at the end is, therefore, an artifact,
as the peaks correspond to the same final configuration for the system.
In a more complex case it might not be possible to distinguish between
peaks in PDFs which are real, ie. correspond to physically different
configurations, from those that arise from deficiencies in the
mathematical tool&nbsp;used.</p>
<p>These spurious peaks generate unrealistic dispersion in the distribution
of results. Is there a way to identify them and get rid of&nbsp;them?</p>
<p>The following python code produces these&nbsp;results.</p>
<div class="highlight"><pre><span></span><span class="c1">#!/bin/python  </span>
<span class="c1"># -*- coding: utf-8 -*-  </span>
<span class="c1"># Small numerical experiments # 00  </span>
<span class="s2">&quot;&quot;&quot;  </span>
<span class="s2">@SNE_number: 00  </span>
<span class="s2">@Title: Stochastic inverse pendulum  </span>
<span class="s2">@Idea: Show a case in which bifurcation behavior produces multimodal</span>
<span class="s2">distribution.  </span>
<span class="s2">@Tags: scipy, ode, stochastic, multimodal, bimodal, matplotlib,</span>
<span class="s2">Monte-Carlo, animation, python  </span>
<span class="s2">@Date: Created on Fri Oct 4 2013  </span>
<span class="s2">@author: jaabell  </span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="s s-Atom">import</span> <span class="s s-Atom">scipy</span> <span class="s s-Atom">as</span> <span class="s s-Atom">sp</span>  
<span class="s s-Atom">import</span> <span class="s s-Atom">matplotlib</span><span class="p">.</span><span class="s s-Atom">pylab</span> <span class="s s-Atom">as</span> <span class="s s-Atom">plt</span>  
<span class="s s-Atom">from</span> <span class="s s-Atom">scipy</span><span class="p">.</span><span class="s s-Atom">integrate</span> <span class="s s-Atom">import</span> <span class="s s-Atom">odeint</span>

<span class="nv">N</span> <span class="o">=</span> <span class="mi">5000</span> <span class="s s-Atom">#</span><span class="p">[]</span> <span class="s s-Atom">number</span> <span class="s s-Atom">of</span> <span class="nv">Monte</span><span class="o">-</span><span class="nv">Carlo</span> <span class="s s-Atom">trials</span>  
<span class="s s-Atom">mu_theta</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="s s-Atom">deg</span><span class="p">]</span>  
<span class="s s-Atom">sigma_theta</span> <span class="o">=</span> <span class="mi">10</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="s s-Atom">deg</span><span class="p">]</span>  
<span class="s s-Atom">tmax</span> <span class="o">=</span> <span class="mi">10</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="s s-Atom">s</span><span class="p">]</span> <span class="nv">Maximum</span> <span class="s s-Atom">time</span> <span class="s s-Atom">for</span> <span class="s s-Atom">simulation</span>  
<span class="s s-Atom">dt</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="s s-Atom">s</span><span class="p">]</span> <span class="nv">Time</span> <span class="s s-Atom">step</span> <span class="s s-Atom">for</span> <span class="s s-Atom">integration</span>  
<span class="s s-Atom">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="s s-Atom">#</span><span class="p">[]</span>  
<span class="s s-Atom">g</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="s s-Atom">m</span><span class="o">/</span><span class="s s-Atom">s\^</span><span class="mi">2</span><span class="p">]</span>  
<span class="s s-Atom">l</span> <span class="o">=</span> <span class="mf">0.50</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="s s-Atom">m</span><span class="p">]</span>  
<span class="s s-Atom">xi</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="s s-Atom">#</span><span class="p">[]</span> <span class="nv">Ratio</span> <span class="s s-Atom">of</span> <span class="s s-Atom">critical</span> <span class="nf">damping</span> <span class="p">(</span><span class="s s-Atom">for</span> <span class="s s-Atom">a</span> <span class="s s-Atom">regular</span> <span class="s s-Atom">pendulum</span> <span class="s s-Atom">under</span>
<span class="s s-Atom">small</span> <span class="s s-Atom">deflections</span><span class="p">)</span>  
<span class="nv">Nbins</span> <span class="o">=</span> <span class="mi">50</span> <span class="s s-Atom">#</span><span class="p">[]</span> <span class="nv">Number</span> <span class="s s-Atom">of</span> <span class="s s-Atom">bins</span> <span class="s s-Atom">for</span> <span class="s s-Atom">computing</span> <span class="s s-Atom">histograms</span>  
<span class="s s-Atom">theta_0_dot</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="s s-Atom">deg</span><span class="o">/</span><span class="s s-Atom">sec</span><span class="p">]</span> <span class="s s-Atom">initial</span> <span class="s s-Atom">angular</span> <span class="s s-Atom">velocity</span> <span class="s s-Atom">for</span> <span class="s s-Atom">pendulums</span>

<span class="s s-Atom">compute</span> <span class="o">=</span> <span class="nv">False</span> <span class="s s-Atom">#</span><span class="nv">Use</span> <span class="s s-Atom">this</span> <span class="s s-Atom">in</span> <span class="s s-Atom">an</span> <span class="s s-Atom">interactive</span> <span class="nf">session</span> <span class="p">(</span><span class="s s-Atom">ie</span><span class="p">.</span> <span class="s s-Atom">spyder</span><span class="p">)</span> <span class="s s-Atom">to</span>
<span class="s s-Atom">avoid</span> <span class="s s-Atom">recomputing</span> <span class="s s-Atom">the</span> <span class="nv">Monte</span><span class="o">-</span><span class="nv">Carlo</span> <span class="s s-Atom">runs</span>

<span class="s s-Atom">c</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="s s-Atom">xi</span><span class="o">*</span><span class="s s-Atom">m</span><span class="o">*</span><span class="s s-Atom">l**</span><span class="mi">2</span> <span class="s s-Atom">#</span><span class="p">[</span><span class="nv">N</span><span class="o">*</span><span class="s s-Atom">m</span><span class="o">*</span><span class="s s-Atom">s</span><span class="o">/</span><span class="s s-Atom">rad</span><span class="p">]</span> <span class="nv">Damping</span> <span class="s s-Atom">constant</span>  
<span class="nv">Nt</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="s s-Atom">tmax</span><span class="o">/</span><span class="s s-Atom">dt</span><span class="p">)</span> <span class="s s-Atom">#</span><span class="p">[]</span> <span class="nv">Number</span> <span class="s s-Atom">of</span> <span class="s s-Atom">simulation</span> <span class="s s-Atom">timesteps</span>

<span class="c1">#Generate parameters for Monte-Carlo trials  </span>
<span class="s s-Atom">mu_theta_rad</span> <span class="o">=</span> <span class="s s-Atom">mu_theta</span><span class="o">*</span><span class="s s-Atom">sp</span><span class="p">.</span><span class="s s-Atom">pi</span><span class="o">/</span><span class="mi">180</span>  
<span class="s s-Atom">sigma_theta_rad</span> <span class="o">=</span> <span class="s s-Atom">sigma_theta</span><span class="o">*</span><span class="s s-Atom">sp</span><span class="p">.</span><span class="s s-Atom">pi</span><span class="o">/</span><span class="mi">180</span>  
<span class="s s-Atom">thetas</span> <span class="o">=</span> <span class="s s-Atom">sp</span><span class="p">.</span><span class="nf">randn</span><span class="p">((</span><span class="nv">N</span><span class="p">))</span><span class="o">*</span><span class="s s-Atom">sigma_theta_rad</span> <span class="o">+</span> <span class="s s-Atom">mu_theta_rad</span>  
<span class="s s-Atom">t</span> <span class="o">=</span> <span class="s s-Atom">sp</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s s-Atom">tmax</span><span class="p">,</span> <span class="s s-Atom">dt</span><span class="p">)</span>

<span class="c1">#Recast problem as a set of first order ODEs  </span>
<span class="s s-Atom">b</span> <span class="o">=</span> <span class="o">-</span><span class="s s-Atom">c/</span><span class="p">(</span><span class="s s-Atom">m</span><span class="o">*</span><span class="s s-Atom">l**</span><span class="mi">2</span><span class="p">)</span>  
<span class="s s-Atom">a</span> <span class="o">=</span> <span class="s s-Atom">g</span><span class="o">/</span><span class="s s-Atom">l</span>  
<span class="s s-Atom">def</span> <span class="nf">func</span><span class="p">(</span><span class="s s-Atom">y</span><span class="p">,</span> <span class="s s-Atom">t</span><span class="p">)</span><span class="s s-Atom">:</span>  
    <span class="s s-Atom">return</span> <span class="p">[</span><span class="s s-Atom">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s s-Atom">a</span><span class="o">*</span><span class="s s-Atom">sp</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="s s-Atom">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s s-Atom">b</span><span class="o">*</span><span class="s s-Atom">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span>

<span class="s s-Atom">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="s s-Atom">y</span><span class="p">,</span><span class="s s-Atom">t</span><span class="p">)</span><span class="s s-Atom">:</span>  
    <span class="s s-Atom">return</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],[</span><span class="s s-Atom">a</span><span class="o">*</span><span class="s s-Atom">sp</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="s s-Atom">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="s s-Atom">b</span><span class="p">]]</span>

<span class="c1">#Do the Monte-Carlo runs  </span>
<span class="s s-Atom">if</span> <span class="nn">compute</span><span class="p">:</span>  
    <span class="s s-Atom">yall</span> <span class="o">=</span> <span class="s s-Atom">sp</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="nv">Nt</span><span class="p">,</span><span class="nv">N</span><span class="p">))</span>  
    <span class="s s-Atom">i</span> <span class="o">=</span> <span class="mi">0</span>  
    <span class="s s-Atom">for</span> <span class="s s-Atom">theta_0</span> <span class="s s-Atom">in</span> <span class="nn">thetas</span><span class="p">:</span>  
        <span class="s s-Atom">y0</span> <span class="o">=</span> <span class="p">[</span><span class="s s-Atom">theta_0</span><span class="o">*</span><span class="s s-Atom">sp</span><span class="p">.</span><span class="s s-Atom">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="s s-Atom">theta_0_dot</span><span class="o">*</span><span class="s s-Atom">sp</span><span class="p">.</span><span class="s s-Atom">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">]</span>  
        <span class="s s-Atom">y</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="s s-Atom">func</span><span class="p">,</span> <span class="s s-Atom">y0</span><span class="p">,</span> <span class="s s-Atom">t</span><span class="p">,</span> <span class="nv">Dfun</span><span class="o">=</span><span class="s s-Atom">gradient</span><span class="p">)</span>  
        <span class="s s-Atom">yall</span><span class="p">[</span><span class="s s-Atom">:</span><span class="p">,</span><span class="s s-Atom">i</span><span class="p">]</span> <span class="o">=</span> <span class="s s-Atom">y</span><span class="p">[</span><span class="s s-Atom">:</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>  
        <span class="s s-Atom">print</span> <span class="s2">&quot;Case {} of {}&quot;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="s s-Atom">i</span><span class="p">,</span><span class="nv">N</span><span class="p">)</span>  
        <span class="s s-Atom">i+=</span> <span class="mi">1</span>

<span class="c1"># Some plotting (animation after a tutorial found in http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/)  </span>
<span class="c1"># Also look at http://matplotlib.org/api/animation_api.html  </span>
<span class="s s-Atom">plt</span><span class="p">.</span><span class="nf">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

<span class="s s-Atom">from</span> <span class="s s-Atom">matplotlib</span> <span class="s s-Atom">import</span> <span class="s s-Atom">animation</span>

<span class="c1"># First set up the figure, the axis, and the plot element we want to</span>
<span class="s s-Atom">animate</span>  
<span class="s s-Atom">fig</span> <span class="o">=</span> <span class="s s-Atom">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>  
<span class="s s-Atom">ax</span> <span class="o">=</span> <span class="s s-Atom">plt</span><span class="p">.</span><span class="nf">axes</span><span class="p">(</span><span class="s s-Atom">xlim=</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="s s-Atom">ylim=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  
<span class="s s-Atom">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">()</span>  
<span class="s s-Atom">ax</span><span class="p">.</span><span class="nf">set_xticks</span><span class="p">(</span><span class="s s-Atom">sp</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">270</span><span class="p">,</span><span class="mi">270</span><span class="p">,</span><span class="s s-Atom">num</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span>  
<span class="s s-Atom">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="err">&quot;$</span><span class="s s-Atom">\\\theta$</span><span class="s2">&quot;)  </span>
<span class="s2">ax.set_ylabel(&quot;</span><span class="err">$</span><span class="s s-Atom">f_</span><span class="p">{</span><span class="s s-Atom">\\\theta</span><span class="p">}(</span><span class="s s-Atom">\\\theta</span><span class="p">,</span> <span class="s s-Atom">t</span><span class="p">)</span><span class="err">$</span><span class="s2">&quot;)</span>

<span class="s2">line, = ax.plot([], [], lw=2)</span>

<span class="s2">time_text = ax.text(-270, 9, &#39;&#39;)#, transform=ax.transAxes)</span>

<span class="s2">from scipy.interpolate import interp1d  </span>
<span class="s2">probability_thresholds = sp.linspace(0,1,21)</span>

<span class="s2">def myhistogram(y):  </span>
<span class="s2">    yn = sp.array(y)  </span>
<span class="s2">    yn.sort()  </span>
<span class="s2">    cdf = sp.linspace(0,1,yn.size)  </span>
<span class="s2">    y_bins = interp1d(cdf, yn, kind=&#39;linear&#39;, axis=-1, copy=True,</span>
<span class="s2">    bounds_error=True)(probability_thresholds)  </span>
<span class="s2">    return probability_thresholds, y_bins</span>

<span class="s2">def init():  </span>
<span class="s2">    line.set_data([],[])  </span>
<span class="s2">    time_text.set_text(&quot;&quot;)  </span>
<span class="s2">    return line, time_text</span>

<span class="s2">def animate(i):  </span>
<span class="s2">    cdf, y_bins = myhistogram(yall[i,:])  </span>
<span class="s2">    pdf = sp.diff(cdf) / sp.diff(y_bins)  </span>
<span class="s2">    y_bins_centers = 0.5*(y_bins[0:-1] + y_bins[1::])  </span>
<span class="s2">    # pdf, y_bins = sp.histogram(yall[i,:], bins = Nbins, density =</span>
<span class="s2">    True)  </span>
<span class="s2">    # y_bins_centers = 0.5*(y_bins[0:-1] + y_bins[1::])  </span>
<span class="s2">    line.set_data(y_bins_centers*180/sp.pi, pdf)  </span>
<span class="s2">    time_text.set_text(&quot;</span><span class="nv">Time</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="s s-Atom">:</span><span class="mf">4.2</span><span class="s s-Atom">f</span><span class="p">}</span> <span class="s s-Atom">s</span><span class="s2">&quot;.format(t[i]))  </span>
<span class="s2">    return line, time_text</span>

<span class="s2">anim = animation.FuncAnimation(fig, animate, init_func=init,  </span>
<span class="s2">frames=1000, interval=1, blit=True)  </span>
<span class="s2">#anim.save(&#39;basic_animation.mp4&#39;, fps=30, extra_args=[&#39;-vcodec&#39;,</span>
<span class="s2">&#39;libx264&#39;])</span>

<span class="s2">plt.show()</span>

<span class="s2">#plt.figure()  </span>
<span class="s2">#plt.plot(t,yall[:,0]*180/sp.pi)  </span>
<span class="s2">#plt.grid()  </span>
<span class="s2">#plt.yticks(sp.linspace(-270,270,num=13))  </span>
<span class="s2">#plt.xlabel(&quot;</span><span class="err">$</span><span class="s s-Atom">t$</span><span class="s2">&quot;)  </span>
<span class="s2">#plt.ylabel(&quot;</span><span class="err">$</span><span class="s s-Atom">\\\</span><span class="nf">theta</span><span class="p">(</span><span class="s s-Atom">t</span><span class="p">)</span><span class="err">$&quot;</span><span class="p">)</span>
</pre></div>


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "left",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' }, Macros: {pare: ['\\\\left( #1 \\\\right)', 1], brak: ['\\\\left[ #1 \\\\right]', 1], brac: ['\\\\left\\\\lbrace #1 \\\\right\\\\rbrace', 1], absol: ['\\\\left\\\\vert #1 \\\\right\\\\vert', 1], overbar: ['\\\\mkern 1.5mu\\\\overline{\\\\mkern-1.5mu#1\\\\mkern-1.5mu}\\\\mkern 1.5mu', 1], EE: ['\\\\times 10^{#1}', 1], eqand: '\\\\, \\\\text{and} \\\\,', qeqand: '\\\\quad \\\\text{and} \\\\quad', qqeqand: '\\\\qquad \\\\text{and} \\\\qquad', HRule: '\\\\rule{\\\\linewidth}{0.2mm}', vect: ['\\\\boldsymbol{#1}', 1], uv: ['\\\\hat{\\\\boldsymbol{#1}}', 1], ud: '\\\\,\\\\mathrm{d}', matorvec: ['\\\\left[\\\\begin{array}{#1}    #2\\\\end{array}\\\\right]', 2], pardiff: ['\\\\dfrac{\\\\partial\\\\, #1}{\\\\partial\\\\, #2}', 2], pp: ['\\\\frac{\\\\partial #1}{\\\\partial #2}', 2], totdiff: ['\\\\dfrac{\\\\ud #1}{\\\\ud #2}', 2], rint: '\\\\pare{R}\\\\hspace{-0.5em} \\\\int ', expon: ['\\\\exp \\\\left\\\\lbrace #1 \\\\right\\\\rbrace', 1], unit: ['   \\\\, \\\\mathrm{#1}                }', 1], bunit: ['  \\\\, \\\\left[ \\\\mathrm{#1} \\\\right] }', 1], funit: ['  \\\\, \\\\mathrm{ \\\\frac{#1}{#2} }   }', 2], bfunit: ['  \\\\, \\\\left[ \\\\mathrm{ {#1}/{#2} } \\\\right]   }', 2], mts: '\\\\bunit{m}', cmts: '\\\\bunit{cm}', mmts: '\\\\bunit{mm}', kmts: '\\\\bunit{km}', mps: '\\\\bfunit{m}{s}', cmpt: '\\\\bfunit{cm}{s}', mmps: '\\\\bfunit{mm}{s}', kmps: '\\\\bfunit{km}{s}', Newt: '\\\\bunit{N}', kNewt: '\\\\bunit{kN}', MNewt: '\\\\bunit{MN}', Pa: '\\\\bunit{Pa}', kPa: '\\\\bunit{kPa}', MPa: '\\\\bunit{MPa}', GPa: '\\\\bunit{GPa}', kNmm: '\\\\bfunit{kN}{m^2}', Nmm: '\\\\bfunit{N}{m^2}', kgmmm: '\\\\bfunit{kg}{m^3}', Mgmmm: '\\\\bfunit{Mg}{m^3}', grcmcmcm: '\\\\bfunit{g}{cm^3}', kNmmm: '\\\\bfunit{kN}{m^3}', gr: '\\\\bunit{g}', mgr: '\\\\bunit{mg}', kgr: '\\\\bunit{kg}', Mgr: '\\\\bunit{Mg}', seg: '\\\\bunit{s}', msec: '\\\\bunit{ms}', musec: '\\\\bunit{\\\\mu s}', mo: '\\\\bunit{month}', mos: '\\\\bunit{months}', days: '\\\\bunit{days}', gs: '\\\\bunit{g}', mss: '\\\\bfunit{m}{s^2}', cmss: '\\\\bfunit{cm}{s^2}', Hz: '\\\\bunit{Hz}', MHz: '\\\\bunit{MHz}', GHz: '\\\\bunit{GHz}', THz: '\\\\bunit{THz}', dgr: '\\\\unit{^{\\\\circ}}', rads: '\\\\bunit{rad}', kips: '\\\\unit{kips}', ksi: '\\\\unit{ksi}', inch: '\\\\unit{in}'} }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'gray ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </div>

        <div class="meta">
            <div>
                    <a href="http://www.joseabell.com/tag/animation.html" class="tag">animation</a>
                    <a href="http://www.joseabell.com/tag/bimodal.html" class="tag">bimodal</a>
                    <a href="http://www.joseabell.com/tag/matplotlib.html" class="tag">matplotlib</a>
                    <a href="http://www.joseabell.com/tag/monte-carlo.html" class="tag">Monte-Carlo</a>
                    <a href="http://www.joseabell.com/tag/multimodal.html" class="tag">multimodal</a>
                    <a href="http://www.joseabell.com/tag/ode.html" class="tag">ode</a>
                    <a href="http://www.joseabell.com/tag/python.html" class="tag">python</a>
                    <a href="http://www.joseabell.com/tag/scipy.html" class="tag">scipy</a>
                    <a href="http://www.joseabell.com/tag/small-numerical-experiments.html" class="tag">small numerical experiments</a>
                    <a href="http://www.joseabell.com/tag/sne.html" class="tag">sne</a>
                    <a href="http://www.joseabell.com/tag/stochastic.html" class="tag">stochastic</a>
            </div>
            <!-- <div>
                <a id="comments-button" class="comments_btn" href="#disqus_thread">Comments</a>
            </div> -->
        </div>
    </article>
</div>


<script type="text/javascript">
(function () {
    'use strict';

    // Global object
    var App = {};

    // Create button
    // App.commentsButton = document.getElementById('comments-button');

    // App.commentsButton.onclick = function () {
    //     // Remove button action on click
        // App.commentsButton.onclick = function () {
        // }

        // Create comments container
        App.disqusContainer = document.createElement('div');
        App.disqusContainer.setAttribute('id', 'disqus_thread');
        // App.disqusContainer.setAttribute('class', 'container');

        // Append container to body or div
        // document.body.appendChild( App.disqusContainer );
        var container = document.getElementsByClassName('container post')[0];
        container.appendChild(App.disqusContainer);

        // Your Disqus shortname
        App.disqus_shortname = 'joseabell';

        // Embed Disqus
        var dsq = document.createElement('script');

        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + App.disqus_shortname + '.disqus.com/embed.js';

        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

    //     window.scrollTo(0, dsq.offsetTop - 200);
    // };
})();
</script>


<!-- 
<script type="text/javascript">
    var disqus_shortname = 'joseabell';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
    }());
</script>
 -->



        <!-- Github buttons. -->
        <script async defer src="https://buttons.github.io/buttons.js"></script>
    </body>
</html>